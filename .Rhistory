idatPath <- "/Volumes/ALSPAC/EPI/EPI_methylation_rawdata_froam_ben_2019_12_20/idat" # path of the folder
targets <- readxl::read_excel("/Volumes/ALSPAC/EPI/Monk_DNA_Methylation_data_Sameera_2022_01_20/monk_sample_info_updated_200122.xlsx") %>%
filter(celltype=='TCELLS' & region=='PERIPHERAL')
targets$Basename <- targets$idat_id#paste0(targets$sentrixbarcode, "_", targets$samplesection) # name of the files
targets=targets[1:5,]
library(dplyr)
idatPath <- "/Volumes/ALSPAC/EPI/EPI_methylation_rawdata_froam_ben_2019_12_20/idat" # path of the folder
targets <- readxl::read_excel("/Volumes/ALSPAC/EPI/Monk_DNA_Methylation_data_Sameera_2022_01_20/monk_sample_info_updated_200122.xlsx") %>%
filter(celltype=='TCELLS' & region=='PERIPHERAL')
targets$Basename <- targets$idat_id#paste0(targets$sentrixbarcode, "_", targets$samplesection) # name of the files
targets=targets[1:5,]
targetfile=targets
rm(targets)
######################################################################
###################Reading in idat files##############################
######################################################################
WB <- read.metharray.exp(base=idatPath, targets=targetfile, verbose=T) # read the idat file one by one
library(minfi)
library(minfi)
######################################################################
###################Reading in idat files##############################
######################################################################
WB <- read.metharray.exp(base=idatPath, targets=targetfile, verbose=T) # read the idat file one by one
ncol(WB)
ewas_meth <- read_idats( paste(idatPath,'/',targetfile$Basename,sep=''), quiet=F)
library(ENmix) # probe type adjustment "rcp"
library(limma)
library(sva) # for addressing batch effects
library(DMRcate)
ewas_meth <- read_idats( paste(idatPath,'/',targetfile$Basename,sep=''), quiet=F)
###################ILLUMINA QC Control Check#########3
# The name of the platform (450K/EPIC)
cat(paste('Platform:', ewas_meth$platform,'\n'))
library(ewastools)
BiocManager::install("ewastools")
library(ewastools)
BiocManager::install("ewastools")
devtools::install_github("hhhh5/ewastools")
devtools::install_github("hhhh5/ewastools")
